<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Finance</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
body{background:#f6f7fb;color:#222}
.app{max-width:480px;margin:0 auto;padding:16px}

/* ===== BALANCE ===== */
.balance-card{
  background:#fff;border-radius:22px;padding:26px 20px;
  text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.06)
}
.balance-label{font-size:14px;color:#777}
.balance-amount{font-size:44px;font-weight:800;margin:10px 0}
.summary{display:flex;gap:10px}
.summary-box{
  flex:1;background:#f4f6fa;border-radius:14px;padding:12px;font-size:13px
}
.income{color:#2e7d32;font-weight:600}
.expense{color:#c62828;font-weight:600}

/* ===== FILTER ===== */
.filters{display:flex;gap:10px;margin:16px 0}
select,button{
  flex:1;padding:10px;border-radius:12px;border:1px solid #ddd;
  background:#fff;font-size:14px
}
.toggle button.active{background:#222;color:#fff}

/* ===== LIST ===== */
.list .item{
  background:#fff;border-radius:14px;padding:12px;
  margin-bottom:10px;display:flex;justify-content:space-between
}
.item .sub{font-size:12px;color:#666}

/* ===== GOAL ===== */
.goal{
  background:#fff;border-radius:18px;padding:16px;margin-top:20px
}
.progress{
  height:10px;background:#eee;border-radius:10px;overflow:hidden;margin-top:8px
}
.progress-bar{height:100%;background:#4caf50;width:0%}
</style>
</head>

<body>
<div class="app">

  <!-- BALANCE -->
  <div class="balance-card">
    <div class="balance-label">Current Balance</div>
    <div class="balance-amount" id="balance">à¸¿0</div>
    <div class="summary">
      <div class="summary-box">Income<br><span id="income" class="income">à¸¿0</span></div>
      <div class="summary-box">Expense<br><span id="expense" class="expense">à¸¿0</span></div>
    </div>
  </div>

  <!-- FILTER -->
  <div class="filters">
    <select id="monthSelect"></select>
    <div class="toggle" style="display:flex;gap:6px">
      <button id="monthlyBtn" class="active">Monthly</button>
      <button id="dailyBtn">Daily</button>
    </div>
  </div>

  <!-- DAILY SUMMARY -->
  <div id="dailySummary" style="display:none;margin-bottom:10px;font-size:14px"></div>

  <!-- LIST -->
  <div class="list" id="list"></div>

  <!-- GOAL -->
  <div class="goal">
    <strong>ðŸŽ¯ Tuition Goal</strong>
    <div class="sub">Saved: <span id="goalSaved">0</span> / <span id="goalTotal">80,000</span></div>
    <div class="progress"><div class="progress-bar" id="goalBar"></div></div>
  </div>

</div>

<script>
// ===== API URL à¸‚à¸­à¸‡à¸„à¸¸à¸“ =====
const API_URL = "https://script.google.com/macros/s/AKfycby-beULXmZtgOGvT7iBbETSZt3GSFEyCVNLmwE51A0Lr1sLvbLb9zGQ5LNf9GDok2l9rg/exec";

let mode = "monthly", data;

// ===== Toggle Monthly / Daily =====
const monthlyBtn = document.getElementById("monthlyBtn");
const dailyBtn = document.getElementById("dailyBtn");

monthlyBtn.onclick = () => switchMode("monthly");
dailyBtn.onclick = () => switchMode("daily");

function switchMode(m){
  mode=m;
  monthlyBtn.classList.toggle("active",m==="monthly");
  dailyBtn.classList.toggle("active",m==="daily");
  render();
}

// ===== Fetch JSON à¸ˆà¸²à¸ Google Apps Script =====
fetch(API_URL)
  .then(r=>r.json())
  .then(j=>{
    data=j;
    initMonth();
    render();
  });

// ===== Init Month Dropdown =====
function initMonth(){
  monthSelect.innerHTML = `<option>${data.month}/${data.year}</option>`;
}

// ===== Render à¸«à¸™à¹‰à¸²à¹€à¸§à¹‡à¸š =====
function render(){
  document.getElementById("balance").textContent = "à¸¿"+data.balance.toLocaleString();
  document.getElementById("income").textContent  = "à¸¿"+data.income.toLocaleString();
  document.getElementById("expense").textContent = "à¸¿"+Math.abs(data.expense).toLocaleString();

  const listEl = document.getElementById("list");
  listEl.innerHTML="";

  const dailySummaryEl = document.getElementById("dailySummary");
  if(mode==="monthly"){
    dailySummaryEl.style.display="none";
    data.list.forEach(addItem);
  }else{
    dailySummaryEl.style.display="block";
    dailySummaryEl.textContent = `Today: +${data.daily.income} / -${data.daily.expense}`;
    data.daily.list.forEach(addItem);
  }

  // Goal
  const saved = data.income + data.expense;
  const total = 80000;
  document.getElementById("goalSaved").textContent = saved.toLocaleString();
  document.getElementById("goalTotal").textContent = total.toLocaleString();
  document.getElementById("goalBar").style.width = Math.min(saved/total*100,100)+"%";
}

// ===== Add Item =====
function addItem(i){
  const el=document.createElement("div");
  el.className="item";
  el.innerHTML=`
    <div>
      <div>ðŸ“… ${i.date}</div>
      <div class="sub">${i.category} Â· ${i.description}</div>
    </div>
    <div class="${i.amount>0?"income":"expense"}">
      ${i.amount>0?"+":""}${i.amount}
    </div>`;
  document.getElementById("list").appendChild(el);
}
</script>
</body>
</html>
